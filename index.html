<script src="https://unpkg.com/testml-compiler/lib/testml/compiler/browser.js"></script>
<script src="https://unpkg.com/lodash/lodash.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>


<h2>TestML Compiler Interactive Demo</h2>
<div id="nav">
<input id="update" type="button" value="Update" onclick="compileTestML()" />
</div>

<textarea id="input"></textarea>
<textarea id="output"></textarea>


<script>
$('#input')[0].value = `\
# A simple testml file

# For test frameworks that support planning:
Plan = 3


# Assertion loops:
*input.get-sha1 == *sha1
*input.get-md5 == *md5


# Test data blocks:
=== Test 1
--- input: I like pie.
--- sha1: 5f30adb9864439315a33e1a6631358164f94cc20

=== Test 2
--- input
I like pie.
--- sha1: 53b3de1f1d480989d391f24a8886d291773347a7
--- md5: 29a529ed285c7f5cd6c3bff4b3bb7626
`

function compileTestML() {
  var input = $('#input')[0].value
  var output

  try {
    output = (new TestML.Compiler).compile(input)
  }
  catch(e) {
    output = String(e)
  }

  $('#output')[0].value = output

  $('#input').focus()
}

compileTestML()
</script>


<style>
body {
    font-family: sans-serif;
}
#nav {
    width: 100%;
    padding-bottom: 5px;
}
textarea {
  font-family: monospace;
  width: 500px;
  height: 500px;
}
#update {
    background-color: yellow;
}
</style>
