// Generated by CoffeeScript 2.3.0
(function() {
  var TestMLError, ___;

  TestMLError = class TestMLError {
    constructor(msg1) {
      this.msg = msg1;
    }

  };

  // For stubbing out possible methods to support:
  ___ = function(desc = '') {
    var name;
    // Get caller name:
    name = 'unknown';
    try {
      Error.prepareStackTrace = function(_, stack) {
        return name = stack[1].getFunctionName();
      };
      Error.captureStackTrace(new Error);
    } catch (error1) {}
    throw `Unimplemented StdLib method: '${name}' - ${desc}`;
  };

  module.exports = TestML.StdLib = class StdLib {
    constructor(run) {
      this.run = run;
    }

    argv() {
      return process.argv.slice(2);
    }

    block(selector) {
      var block, i, len, ref;
      if (selector == null) {
        return this.run.block;
      }
      ref = this.run.data;
      for (i = 0, len = ref.length; i < len; i++) {
        block = ref[i];
        if (block.label === selector) {
          return block;
        }
      }
    }

    blocks() {
      return _.clone(this.run.data);
    }

    bool(value) {
      return !(value === void 0 || value === null || value === false);
    }

    cat(...strings) {
      if (strings[0] instanceof Array) {
        strings = strings[0];
      }
      return strings.join('');
    }

    count(list) {
      return list.length;
    }

    error(error = '') {
      return new TestMLError(error);
    }

    env() {
      return this._env || (this._env = (function() {
        var env, key, ref, value;
        env = {};
        ref = process.env;
        for (key in ref) {
          value = ref[key];
          env[key] = value;
        }
        return env;
      })());
    }

    false() {
      return false;
    }

    first(list) {
      return _.first(list);
    }

    flat(list, depth = 9999999999) {
      return _.flattenDepth(list, depth);
    }

    hash(...values) {
      var hash, i, key, len, val;
      hash = {};
      for (val = i = 0, len = values.length; i < len; val = ++i) {
        key = values[val];
        hash[key] = val;
      }
      return hash;
    }

    head(list) {
      return _.head(list);
    }

    identity(value) {
      return value;
    }

    import() {
      return ___('Runtime .tml import (possibly data only)');
    }

    join(list, separator = ' ') {
      return _.join(list, separator);
    }

    last(list) {
      return _.last(list);
    }

    length(str) {
      return str.length;
    }

    lines(text) {
      text = text.replace(/\n$/, '');
      return text.split(/\n/);
    }

    list(...values) {
      return values;
    }

    null() {
      return null;
    }

    none() {}

    num(value) {
      return Number(value);
    }

    push(list, ...values) {
      list.push(...values);
      return list;
    }

    pop(list) {
      list.pop();
      return list;
    }

    regex(pattern, flags = '') {
      return new RegExp(pattern, flags);
    }

    say(msg) {
      if (!msg.match(/\n$/)) {
        msg = `${msg}\n`;
      }
      return this.run.out(msg);
    }

    shift(list) {
      list.shift();
      return list;
    }

    split(string, delim = /\s+/, limit = 9999999999) {
      return _.split(string, delim, limit);
    }

    str(value) {
      return String(value);
    }

    sum(...list) {
      if (list[0] instanceof Array) {
        list = list[0];
      }
      return _.sum(list);
    }

    tail(list) {
      return _.tail(list);
    }

    text(list) {
      return [...list, ''].join('\n');
    }

    throw(error = '') {
      throw error;
    }

    true() {
      return true;
    }

    type(value) {
      return this.run.type(this.run.cook(value));
    }

    unshift(list, ...values) {
      list.unshift(...values);
      return list;
    }

    warn(msg) {
      if (!msg.match(/\n$/)) {
        msg = `${msg}\n`;
      }
      return this.run.err(msg);
    }

    //----------------------------------------------------------------------------
    eq(x, y) {
      return ___('test if x == y');
    }

    gt(x, y) {
      return ___('test if x > y');
    }

    ge(x, y) {
      return ___('test if x >= y');
    }

    lt(x, y) {
      return ___('test if x < y');
    }

    le(x, y) {
      return ___('test if x <= y');
    }

  };

}).call(this);
